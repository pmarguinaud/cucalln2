MODULE UTIL_TTHF_MOD

USE YOETHF, ONLY : TTHF

INTERFACE SAVE
MODULE PROCEDURE SAVE_TTHF
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TTHF
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TTHF
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TTHF
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TTHF
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TTHF
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TTHF
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TTHF (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TTHF), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%R2ES
WRITE (KLUN) YD%R3LES
WRITE (KLUN) YD%R3IES
WRITE (KLUN) YD%R4LES
WRITE (KLUN) YD%R4IES
WRITE (KLUN) YD%R5LES
WRITE (KLUN) YD%R5IES
WRITE (KLUN) YD%RVTMP2
WRITE (KLUN) YD%RHOH2O
WRITE (KLUN) YD%R5ALVCP
WRITE (KLUN) YD%R5ALSCP
WRITE (KLUN) YD%RALVDCP
WRITE (KLUN) YD%RALSDCP
WRITE (KLUN) YD%RALFDCP
WRITE (KLUN) YD%RTWAT
WRITE (KLUN) YD%RTBER
WRITE (KLUN) YD%RTBERCU
WRITE (KLUN) YD%RTICE
WRITE (KLUN) YD%RTICECU
WRITE (KLUN) YD%RTWAT_RTICE_R
WRITE (KLUN) YD%RTWAT_RTICECU_R
WRITE (KLUN) YD%RKOOP1
WRITE (KLUN) YD%RKOOP2
END SUBROUTINE

SUBROUTINE LOAD_TTHF (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TTHF), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) ZTMP0
YD%R2ES = ZTMP0
READ (KLUN) ZTMP0
YD%R3LES = ZTMP0
READ (KLUN) ZTMP0
YD%R3IES = ZTMP0
READ (KLUN) ZTMP0
YD%R4LES = ZTMP0
READ (KLUN) ZTMP0
YD%R4IES = ZTMP0
READ (KLUN) ZTMP0
YD%R5LES = ZTMP0
READ (KLUN) ZTMP0
YD%R5IES = ZTMP0
READ (KLUN) ZTMP0
YD%RVTMP2 = ZTMP0
READ (KLUN) ZTMP0
YD%RHOH2O = ZTMP0
READ (KLUN) ZTMP0
YD%R5ALVCP = ZTMP0
READ (KLUN) ZTMP0
YD%R5ALSCP = ZTMP0
READ (KLUN) ZTMP0
YD%RALVDCP = ZTMP0
READ (KLUN) ZTMP0
YD%RALSDCP = ZTMP0
READ (KLUN) ZTMP0
YD%RALFDCP = ZTMP0
READ (KLUN) ZTMP0
YD%RTWAT = ZTMP0
READ (KLUN) ZTMP0
YD%RTBER = ZTMP0
READ (KLUN) ZTMP0
YD%RTBERCU = ZTMP0
READ (KLUN) ZTMP0
YD%RTICE = ZTMP0
READ (KLUN) ZTMP0
YD%RTICECU = ZTMP0
READ (KLUN) ZTMP0
YD%RTWAT_RTICE_R = ZTMP0
READ (KLUN) ZTMP0
YD%RTWAT_RTICECU_R = ZTMP0
READ (KLUN) ZTMP0
YD%RKOOP1 = ZTMP0
READ (KLUN) ZTMP0
YD%RKOOP2 = ZTMP0
END SUBROUTINE


SUBROUTINE COPY_TTHF (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTHF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF























END SUBROUTINE

SUBROUTINE HOST_TTHF (YD)

IMPLICIT NONE
TYPE (TTHF), TARGET :: YD
























END SUBROUTINE

     

SUBROUTINE CRC64_TTHF (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC

IMPLICIT NONE
TYPE (TTHF), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R2ES), CDPATH//'%R2ES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R3LES), CDPATH//'%R3LES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R3IES), CDPATH//'%R3IES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R4LES), CDPATH//'%R4LES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R4IES), CDPATH//'%R4IES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R5LES), CDPATH//'%R5LES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R5IES), CDPATH//'%R5IES'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RVTMP2), CDPATH//'%RVTMP2'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RHOH2O), CDPATH//'%RHOH2O'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R5ALVCP), CDPATH//'%R5ALVCP'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%R5ALSCP), CDPATH//'%R5ALSCP'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RALVDCP), CDPATH//'%RALVDCP'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RALSDCP), CDPATH//'%RALSDCP'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RALFDCP), CDPATH//'%RALFDCP'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTWAT), CDPATH//'%RTWAT'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTBER), CDPATH//'%RTBER'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTBERCU), CDPATH//'%RTBERCU'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTICE), CDPATH//'%RTICE'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTICECU), CDPATH//'%RTICECU'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTWAT_RTICE_R), CDPATH//'%RTWAT_RTICE_R'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RTWAT_RTICECU_R), CDPATH//'%RTWAT_RTICECU_R'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RKOOP1), CDPATH//'%RKOOP1'

WRITE (KLUN, '(Z16.16," ",A)') CRC64 (YD%RKOOP2), CDPATH//'%RKOOP2'

END SUBROUTINE

SUBROUTINE WIPE_TTHF (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTHF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF























LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TTHF (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TTHF),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%R2ES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R2ES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R3LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R3LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R3IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R3IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R4LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R4LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R4IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R4IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R5LES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5LES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R5IES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5IES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVTMP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVTMP2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RHOH2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RHOH2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R5ALVCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5ALVCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%R5ALSCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%R5ALSCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RALVDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALVDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RALSDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALSDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RALFDCP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RALFDCP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTWAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTBER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTBER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTBERCU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTBERCU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTICECU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTICECU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTWAT_RTICE_R)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT_RTICE_R'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTWAT_RTICECU_R)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTWAT_RTICECU_R'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RKOOP1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RKOOP1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RKOOP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RKOOP2'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
